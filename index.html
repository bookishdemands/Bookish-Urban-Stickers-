<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Urban Fiction Sticker Prompt Generator</title>
  <style>
    :root{
      --bg:#0f0f14;
      --card:#171723;
      --muted:#a9a9b7;
      --text:#f3f3f7;
      --accent:#ff4fa3;
      --accent2:#20e3b2;
      --line:#2a2a3a;
      --chip:#222235;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 18px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:var(--sans);
      background:
        radial-gradient(900px 500px at 10% 0%, rgba(255,79,163,.18), transparent 55%),
        radial-gradient(900px 500px at 90% 10%, rgba(32,227,178,.14), transparent 55%),
        radial-gradient(900px 500px at 40% 110%, rgba(255,205,115,.10), transparent 55%),
        var(--bg);
      color:var(--text);
    }
    a{color:inherit}
    .wrap{
      max-width: 1100px;
      margin: 0 auto;
      padding: 26px 16px 60px;
    }
    header{
      display:flex;
      flex-wrap:wrap;
      align-items:flex-end;
      justify-content:space-between;
      gap: 14px;
      margin-bottom: 16px;
    }
    .title{
      display:flex;
      flex-direction:column;
      gap: 6px;
    }
    h1{
      margin:0;
      font-size: clamp(22px, 3.2vw, 34px);
      letter-spacing:.2px;
    }
    .subtitle{
      color: var(--muted);
      line-height:1.35;
      max-width: 66ch;
    }
    .badgeRow{
      display:flex;
      gap: 10px;
      flex-wrap:wrap;
      justify-content:flex-end;
    }
    .badge{
      background: rgba(255,255,255,.05);
      border: 1px solid rgba(255,255,255,.08);
      padding: 8px 10px;
      border-radius: 999px;
      color: var(--muted);
      font-size: 12px;
    }
    .badge b{color:var(--text); font-weight:600}
    .grid{
      display:grid;
      grid-template-columns: 1.05fr .95fr;
      gap: 16px;
      margin-top: 18px;
    }
    @media (max-width: 920px){
      .grid{grid-template-columns: 1fr}
      .badgeRow{justify-content:flex-start}
    }
    .card{
      background: rgba(255,255,255,.03);
      border: 1px solid rgba(255,255,255,.08);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .cardHead{
      padding: 14px 16px;
      border-bottom: 1px solid rgba(255,255,255,.07);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
    }
    .cardHead h2{
      margin:0;
      font-size: 14px;
      letter-spacing:.6px;
      text-transform: uppercase;
      color: rgba(243,243,247,.9);
    }
    .cardBody{padding: 14px 16px 16px}
    .row{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-bottom: 12px;
    }
    @media (max-width: 520px){
      .row{grid-template-columns: 1fr}
    }
    label{
      display:block;
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 6px;
    }
    select, input[type="text"], textarea{
      width:100%;
      padding: 10px 11px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.25);
      color: var(--text);
      outline:none;
    }
    textarea{
      min-height: 122px;
      font-family: var(--mono);
      font-size: 12.5px;
      line-height: 1.35;
      resize: vertical;
    }
    .quoteBox{
      display:grid;
      grid-template-columns: 1fr;
      gap: 10px;
      margin-bottom: 12px;
    }
    .toggle{
      display:flex;
      align-items:center;
      gap: 10px;
      padding: 10px 11px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      color: var(--muted);
      user-select:none;
    }
    .toggle input{width:18px; height:18px}
    .buttons{
      display:flex;
      gap: 10px;
      flex-wrap:wrap;
      margin-top: 8px;
    }
    button{
      border: 0;
      border-radius: 999px;
      padding: 11px 14px;
      font-weight: 650;
      letter-spacing:.15px;
      cursor:pointer;
      color: #0f0f14;
      background: linear-gradient(135deg, var(--accent), #ffcc73);
      box-shadow: 0 10px 25px rgba(255,79,163,.18);
    }
    button.secondary{
      background: rgba(255,255,255,.08);
      color: var(--text);
      border: 1px solid rgba(255,255,255,.12);
      box-shadow:none;
    }
    button.ghost{
      background: transparent;
      color: var(--text);
      border: 1px solid rgba(255,255,255,.18);
      box-shadow:none;
    }
    button:active{transform: translateY(1px)}
    .hint{
      color: var(--muted);
      font-size: 12px;
      margin-top: 10px;
      line-height:1.4;
    }
    .toast{
      position: fixed;
      left: 50%;
      bottom: 18px;
      transform: translateX(-50%);
      background: rgba(20,20,30,.92);
      border: 1px solid rgba(255,255,255,.12);
      color: var(--text);
      padding: 10px 12px;
      border-radius: 999px;
      font-size: 12px;
      opacity: 0;
      pointer-events:none;
      transition: opacity .18s ease;
      box-shadow: var(--shadow);
      max-width: calc(100vw - 24px);
      white-space: nowrap;
      overflow:hidden;
      text-overflow: ellipsis;
    }
    .toast.show{opacity: 1}
    .mini{
      font-family: var(--mono);
      font-size: 11.5px;
      color: rgba(243,243,247,.85);
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 999px;
      padding: 6px 10px;
    }
    .footerNote{
      margin-top: 14px;
      color: var(--muted);
      font-size: 12px;
      line-height:1.5;
    }
    .footerNote b{color: var(--text)}
    .multiHint{
      color: var(--muted);
      font-size: 11.5px;
      margin-top: 6px;
      line-height: 1.35;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div class="title">
        <h1>Urban Fiction Sticker Prompt Generator</h1>
        <div class="subtitle">
          Pick your vibe, icon, accents, palette, quote ‚Äî and now also choose <b>product-style stickers</b> (medical, candy, energy, seasonings, hot sauce, honey).
          Generates Ideogram-ready prompts with <b>clear legible typography</b>. üñ§üèôüíã
        </div>
      </div>
      <div class="badgeRow">
        <div class="badge"><b>Outputs:</b> Prompt + Negative + Export Notes</div>
        <div class="badge"><b>Format:</b> One-file webpage</div>
        <div class="badge"><b>Use:</b> Ideogram (optimized)</div>
      </div>
    </header>

    <div class="grid">
      <!-- Controls -->
      <section class="card">
        <div class="cardHead">
          <h2>Inputs</h2>
          <span class="mini" id="seedLabel">Ideogram Text Rules: Locked ‚úÖ</span>
        </div>
        <div class="cardBody">

          <!-- NEW: Genre + Prompt Count -->
          <div class="row">
            <div>
              <label for="genre">Genre / Tone</label>
              <select id="genre">
                <option value="urban_fiction">üî• Urban Fiction</option>
                <option value="dark_romance">üñ§ Dark Romance</option>
                <option value="black_paranormal">üåë Black Paranormal</option>
                <option value="black_romance">üëë Black Romance</option>
                <option value="thriller">üî™ Thriller</option>
                <option value="fantasy">üêâ Fantasy</option>
                <option value="after_dark">üå∂üå∂üå∂üå∂ After Dark (implied)</option>
                <option value="uncensored">üå∂üå∂üå∂üå∂üå∂ Uncensored (implied)</option>
              </select>
            </div>

            <div>
              <label for="count">Generate How Many (1‚Äì5)</label>
              <select id="count">
                <option>1</option>
                <option>2</option>
                <option selected>3</option>
                <option>4</option>
                <option>5</option>
              </select>
            </div>
          </div>

          <div class="row">
  <div>
    <label for="titleText">Title (packaging label / optional)</label>
    <input id="titleText" type="text" placeholder='Example: "Obsession Infusion"' maxlength="60" />
  </div>

  <div>
    <label for="subtitleText">Subtitle (packaging label / optional)</label>
    <input id="subtitleText" type="text" placeholder='Example: "Side Effects: Possessive Behavior"' maxlength="80" />
  </div>
</div>

<div class="row">
  <div>
    <label for="spice">Spice Level (1‚Äì5)</label>
    <select id="spice">
      <option value="1">üå∂ 1 ‚Äî Slow Burn</option>
      <option value="2">üå∂üå∂ 2 ‚Äî Heated Tension</option>
      <option value="3" selected>üå∂üå∂üå∂ 3 ‚Äî High Heat</option>
      <option value="4">üå∂üå∂üå∂üå∂ 4 ‚Äî After Dark</option>
      <option value="5">üå∂üå∂üå∂üå∂üå∂ 5 ‚Äî Uncensored (implied)</option>
    </select>
  </div>

  <div>
    <label class="toggle" style="margin-top: 22px;">
      <input id="spiceStamp" type="checkbox" checked />
      Add ‚ÄúMature/After Dark‚Äù stamp to prompt
    </label>
  </div>
</div>

          <div class="row">
            <div>
              <label for="vibe">Vibe</label>
              <select id="vibe">
                <option>Street Luxe</option>
                <option>Ride-or-Die Romance</option>
                <option>Spicy Reader</option>
                <option>Hustle & Heart</option>
                <option>Midnight City Love</option>
              </select>
            </div>

            <div>
              <label for="type">Sticker Type</label>
              <select id="type">
                <option>Icon + Quote</option>
                <option>Icon Only</option>
                <option>Quote Only</option>
              </select>
            </div>
          </div>

          <!-- NEW: Product Types (mix/match) -->
          <div class="row">
            <div>
              <label for="products">Product Types (mix & match)</label>
              <select id="products" multiple size="8">
                <option value="iv_bag">IV Bag</option>
                <option value="pill_bottle">Pill Bottle</option>
                <option value="prescription_pad">Prescription Pad</option>
                <option value="heart_monitor">Heart Monitor</option>
                <option value="toe_tag">Toe Tag</option>

                <option value="juice_bottle">Juice Bottle</option>
                <option value="energy_can">Energy Drink Can</option>
                <option value="candy_wrapper">Candy Wrapper</option>

                <option value="seasoning_bottle">Seasoning Bottle</option>
                <option value="hot_sauce">Hot Sauce Bottle</option>
                <option value="honey_jar">Honey Jar</option>
              </select>
              <div class="multiHint">Tip: Hold Ctrl (Windows) / Cmd (Mac) to pick multiple. Leave empty to use the Icon Object list below.</div>
            </div>

            <div>
              <label for="object">Main Object (Icon mode)</label>
              <select id="object">
                <option>stack of books with a gold heart charm</option>
                <option>Kindle e-reader with sparkles</option>
                <option>glossy lips with a tiny crown</option>
                <option>fresh sneakers with shine highlights</option>
                <option>city skyline silhouette with a heart</option>
                <option>gold chain shaped like a heart</option>
                <option>rose wrapped in barbed-wire ribbon</option>
                <option>coffee cup with ‚Äúlate night reads‚Äù vibe</option>
                <option>manicure nails + ring sparkle icon</option>
                <option>queen crown with diamond shine</option>
                <option>money stack tied with a satin bow</option>
                <option>perfume bottle with glam aura</option>
                <option>hand holding car keys with sparkle</option>
                <option>hoodie + crown emblem</option>
                <option>open book with subtle flames</option>
              </select>
            </div>
          </div>

          <div class="row">
            <div>
              <label for="accents">Accent Set</label>
              <select id="accents">
                <option>tiny sparkles + dots</option>
                <option>soft neon glow accents</option>
                <option>small hearts + shine highlights</option>
                <option>light smoke wisps + sparkles</option>
                <option>gold shine accents + glitter dots</option>
              </select>
            </div>

            <div>
              <label for="palette">Palette</label>
              <select id="palette">
                <option>Caramel + Gold + Black</option>
                <option>Burgundy + Chocolate + Gold</option>
                <option>Blush + Cocoa + Cream</option>
                <option>Midnight + Neon + Gold</option>
              </select>
            </div>
          </div>

          <!-- NEW: Outline toggle + Typography toggle -->
          <div class="row">
            <div>
              <label for="outline">Sticker Outline</label>
              <select id="outline">
                <option>Thick black outline (recommended)</option>
                <option>No outline</option>
              </select>
            </div>

            <div>
              <label for="border">Sticker Border</label>
              <select id="border">
                <option>White border (recommended)</option>
                <option>No border</option>
              </select>
            </div>
          </div>

          <div class="quoteBox">
            <div>
              <label for="quote">Label/Quote Text (optional if random is ON)</label>
              <input id="quote" type="text" placeholder='Example: "Obsession Infusion" or "He Don‚Äôt Play About Me."' maxlength="120" />
            </div>

            <label class="toggle">
              <input id="useRandom" type="checkbox" checked />
              Use random text (mature vibe, not explicit)
            </label>

            <label class="toggle">
              <input id="enhancedType" type="checkbox" checked />
              Enhanced Typography Mode (Ideogram-safe)
            </label>
          </div>

          <div class="buttons">
            <button id="generateBtn">Generate Prompt(s)</button>
            <button class="secondary" id="copyBtn">Copy Prompt</button>
            <button class="ghost" id="randomBtn">Randomize All</button>
            <button class="ghost" id="clearBtn">Clear</button>
          </div>

          <div class="hint">
            Tip: Select product types for <b>packaging-style stickers</b> (labels + subtitles). Leave product types blank to use your <b>Icon + Quote</b> workflow.
          </div>
        </div>
      </section>

      <!-- Outputs -->
      <section class="card">
        <div class="cardHead">
          <h2>Outputs</h2>
          <span class="mini" id="statusPill">Ready</span>
        </div>
        <div class="cardBody">
          <div style="margin-bottom:12px;">
            <label for="promptOut">Prompt</label>
            <textarea id="promptOut" readonly></textarea>
          </div>

          <div style="margin-bottom:12px;">
            <label for="negOut">Negative Prompt</label>
            <textarea id="negOut" readonly></textarea>
          </div>

          <div>
            <label for="notesOut">Export Notes</label>
            <textarea id="notesOut" readonly></textarea>
          </div>

          <div class="footerNote">
            <b>Commercial safety:</b> keep it original ‚Äî avoid brand names, real book titles, celebrity likeness, and copyrighted characters.
          </div>
        </div>
      </section>
    </div>
  </div>

  <div class="toast" id="toast">Copied!</div>

  <script>
    // ---- Quote bank: Urban-fiction-safe (mature vibe, not explicit) ----
    const QUOTES = [
      "He Don‚Äôt Play About Me.",
      "Soft For You. Savage For Them.",
      "Love Me Loud.",
      "I Like My Love A Little Dangerous.",
      "Chosen, Not Chased.",
      "Pressure Makes Diamonds.",
      "Hood Love. Real Love.",
      "Built Different. Loved Hard.",
      "Say Less. Love More.",
      "Keep It Cute, Or Keep It Moving.",
      "Main Character, No Apologies.",
      "He‚Äôs Trouble & I Like It.",
      "Certified Heart Snatcher.",
      "Loyalty Looks Good On Me.",
      "I‚Äôm The Plot Twist.",
      "We Outside‚Ä¶ But Make It Luxury.",
      "Don‚Äôt Test My Peace.",
      "Pretty With A Backbone.",
      "Crowned In Confidence.",
      "I Came To Win.",
      "Hands Off‚ÄîThat‚Äôs Mine.",
      "Bad Decisions, Great Chemistry.",
      "Too Fly To Beg.",
      "Love With A Side Of Chaos.",
      "Catch Feelings, Not Attitudes.",
      "He Got Me In My Soft Era.",
      "Energy Expensive.",
      "Mind On Money, Heart On You.",
      "City Lights, Late Nights.",
      "Booked & Busy.",
      "Read Now, Cry Later.",
      "Spicy Chapter Energy.",
      "Good Girl? Depends.",
      "I Don‚Äôt Compete‚ÄîI Collect.",
      "Love That Talks Back.",
      "Make Him Earn It.",
      "Protective Energy Only.",
      "Don‚Äôt Play In My Face.",
      "I Like My Stories Unhinged.",
      "Fine Print: I‚Äôm Him.",
      "Act Right, Get Loved Right.",
      "Respectfully‚Ä¶ Try Again.",
      "Heaven Sent, Hood Raised.",
      "If It‚Äôs Not Real, I Don‚Äôt Want It.",
      "Built On Trust, Not Talk.",
      "Talk Nice To Me.",
      "I‚Äôm The Prize, Period."
    ];

    // ---- Ideogram Typography Standard (your requirement) ----
    function typographyBlock(enhanced){
      return enhanced
        ? "centered composition, bold high-contrast text, clear legible typography, perfectly spelled words, no distorted letters, no warped text"
        : "centered composition, bold high-contrast text, clear legible typography, no distorted letters";
    }

    function spiceProfile(level){
  const L = String(level);

  // Implied, not explicit. This stays within your ‚Äúafter dark‚Äù vibe without graphic content.
  const map = {
    "1": {
      name: "Slow Burn",
      vibe: "slow-burn tension, romantic yearning, intimate vibe",
      stamp: ""
    },
    "2": {
      name: "Heated Tension",
      vibe: "heated tension, jealous undertones, close-proximity energy",
      stamp: ""
    },
    "3": {
      name: "High Heat",
      vibe: "high-heat chemistry, dominant energy, possessive tone",
      stamp: "warning label accent"
    },
    "4": {
      name: "After Dark",
      vibe: "after-dark mood, private suite energy, mature tone",
      stamp: "18+ mature readers only stamp"
    },
    "5": {
      name: "Uncensored (implied)",
      vibe: "unfiltered obsession energy, high-risk vibe, adults only tone",
      stamp: "adults only stamp"
    }
  };

  return map[L] || map["3"];
}
    
    // ---- Product Templates (all the stuff you asked across the chat) ----
    const PRODUCT_TEMPLATES = {
      iv_bag: {
        subject: "a medical IV drip bag",
        extras: "subtle glossy shine highlights, modern bold typography, clean flat shading"
      },
      pill_bottle: {
        subject: "a prescription pill bottle",
        extras: "glossy highlight on plastic, clean label panel, subtle barcode detail, minimal flat shading"
      },
      prescription_pad: {
        subject: "a prescription pad sheet",
        extras: "paper texture detail, clean header area, subtle barcode detail, crisp vector lines"
      },
      heart_monitor: {
        subject: "a heart monitor screen",
        extras: "ECG line detail, subtle screen glow, clean display layout, minimal flat shading"
      },
      toe_tag: {
        subject: "a toe tag",
        extras: "barcode detail, clean tag hole, minimal flat shading, bold centered typography"
      },
      juice_bottle: {
        subject: "a plastic juice bottle with bold rectangular label panel",
        extras: "glossy plastic bottle highlights, clean commercial label layout, crisp edges"
      },
      energy_can: {
        subject: "a tall slim aluminum energy drink can",
        extras: "metallic can texture effect, glossy highlights, bold label panel, crisp edges"
      },
      candy_wrapper: {
        subject: "a rectangular hard candy wrapper with twisted ends",
        extras: "cellophane wrapper shine effect, bold flavor panel, clean commercial candy layout"
      },
      seasoning_bottle: {
        subject: "a premium spice seasoning bottle",
        extras: "glossy plastic lid detail, bold flavor label, clean gourmet packaging aesthetic"
      },
      hot_sauce: {
        subject: "a glass hot sauce bottle with visible sauce inside",
        extras: "glossy glass highlights, bold rectangular label, clean gourmet packaging layout"
      },
      honey_jar: {
        subject: "a clear glass honey jar with gold lid and dripping honey detail",
        extras: "glossy glass highlights, warm golden honey color, clean artisan label layout"
      }
    };

    const GENRE_DEFAULTS = {
      urban_fiction: [
        ["Ride or Die Heat", "Flavor: Loyalty & Chaos"],
        ["Street Romance Supply", "Rated R for Real"],
        ["Hood Honey", "Sweet but Not Safe"]
      ],
      dark_romance: [
        ["Obsession Infusion", "Side Effects: Possessive Behavior"],
        ["Villain Era Blend", "No Redemption Arc"],
        ["Fatal Attraction", "Highly Addictive"]
      ],
      black_paranormal: [
        ["Shadow King Serum", "Immortal Bond Activated"],
        ["Ancestral Power", "Bloodline Magic Inside"],
        ["Marked", "Cursed & Claimed"]
      ],
      black_romance: [
        ["Soft Life Transfusion", "Luxury Love Only"],
        ["Golden Hour Glow", "Affection Guaranteed"],
        ["Fine & Faithful", "Love, But Premium"]
      ],
      thriller: [
        ["Plot Twist Drip", "Warning: Unstable Ending"],
        ["Adrenaline Dose", "Do Not Read Alone"],
        ["Unstable", "Expect the Unexpected"]
      ],
      fantasy: [
        ["Dragon Bond Elixir", "Fire-Bound Forever"],
        ["Blood Oath Blend", "Soulbound Contract"],
        ["Enchanted", "Fate Activated"]
      ],
      after_dark: [
        ["After Dark", "After Midnight Only"],
        ["Private Suite", "Do Not Disturb"],
        ["Restricted Access", "Mature Readers Only"]
      ],
      uncensored: [
        ["Unfiltered", "Adults Only"],
        ["High Risk", "Handle With Care"],
        ["Marked", "No Turning Back"]
      ]
    };

    // ---- Fixed "house style" lock (now includes outline toggle + ideogram typography) ----
    function houseStyle(borderChoice, outlineChoice, enhancedType, spiceLevel, spiceStampOn){
  const border = (borderChoice.startsWith("White")) ? "add a clean white sticker border/offset outline" : "no border";
  const outline = (outlineChoice.startsWith("Thick"))
    ? "thick bold black outline"
    : "no outline";

  const spice = spiceProfile(spiceLevel);
  const spiceBits = spiceStampOn
    ? `${spice.vibe}, ${spice.stamp}`
    : `${spice.vibe}`;

  return [
    outline,
    typographyBlock(enhancedType),
    spiceBits,
    "clean doodle clipart illustration",
    "rounded cute shapes",
    "minimal flat shading",
    "subtle grain texture",
    "crisp edges, vector-like clarity",
    border,
    "transparent background",
    "high resolution"
  ].join(", ");
}
    function paletteText(p){
      switch(p){
        case "Caramel + Gold + Black":
          return "warm caramel browns, gold highlights, deep black accents";
        case "Burgundy + Chocolate + Gold":
          return "deep burgundy, rich chocolate browns, gold highlights";
        case "Blush + Cocoa + Cream":
          return "soft blush pink, cocoa browns, creamy off-white highlights";
        case "Midnight + Neon + Gold":
          return "midnight black, subtle neon accents, gold highlights";
        default:
          return p;
      }
    }

    function getRandom(arr){ return arr[Math.floor(Math.random() * arr.length)]; }

    function getSelectedValues(selectEl){
      return Array.from(selectEl.selectedOptions).map(o => o.value);
    }

    // ---- Build ONE prompt (Icon flow OR Product/Packaging flow) ----
    function buildSinglePrompt({
  genre, vibe, type, object, accents, palette, border, outline,
  useRandom, enhancedType, selectedProducts, index,
  spiceLevel, spiceStampOn, userTitle, userSubtitle
}){
  const locked = houseStyle(border, outline, enhancedType, spiceLevel, spiceStampOn);

  // If packaging/product types are selected:
  if(selectedProducts.length){
    const defaults = GENRE_DEFAULTS[genre] || GENRE_DEFAULTS.urban_fiction;
    const pick = getRandom(defaults);

    const title = userTitle || pick[0];
    const subtitle = userSubtitle || pick[1];

    return buildPackagingPrompt({
      locked,
      palette,
      accents,
      productKey: selectedProducts[index % selectedProducts.length],
      title,
      subtitle
    });
  }

  // Icon workflow:
  let text = document.getElementById("quote").value.trim();
  if(useRandom || !text){
    text = getRandom(QUOTES);
  }

  // If user provided Title/Sub and no product selected, we can optionally use Title as the quote
  // (handy when you want quote-only stickers that match your packaging line naming).
  if(userTitle && !text){
    text = userTitle;
  }

  if(type === "Icon + Quote"){
    return `Urban fiction inspired sticker design (${vibe}), ${locked}, rich warm palette: ${paletteText(palette)}, main icon: ${object}, add accents: ${accents}, add caption text: ‚Äú${text}‚Äù in bold modern typography, commercial clipart style, no realism, no brand logos, no watermark.`;
  } else if(type === "Icon Only"){
    return `Urban fiction inspired sticker icon (${vibe}), ${locked}, rich warm palette: ${paletteText(palette)}, main icon: ${object}, add accents: ${accents}, commercial clipart style, no text, no realism, no brand logos, no watermark.`;
  } else {
    return `Urban fiction quote sticker (${vibe}), ${locked}, rich warm palette: ${paletteText(palette)}, caption text only: ‚Äú${text}‚Äù in bold modern typography, add small accent marks: ${accents}, commercial clipart style, no realism, no brand logos, no watermark.`;
  }
}
      // If product types selected AND user typed custom text:
      // Use that as MAIN TITLE and generate a genre subtitle automatically.
      if(selectedProducts.length){
        const pick = getRandom(GENRE_DEFAULTS[genre] || GENRE_DEFAULTS.urban_fiction);
        return buildPackagingPrompt({
          locked,
          palette,
          accents,
          productKey: selectedProducts[index % selectedProducts.length],
          title: text,
          subtitle: pick[1]
        });
      }

      // Otherwise: original icon workflow (with improved typography baked in via locked)
      if(type === "Icon + Quote"){
        return `Urban fiction inspired sticker design (${vibe}), ${locked}, rich warm palette: ${paletteText(palette)}, main icon: ${object}, add accents: ${accents}, add caption text: ‚Äú${text}‚Äù in bold modern typography, commercial clipart style, no realism, no brand logos, no watermark.`;
      } else if(type === "Icon Only"){
        return `Urban fiction inspired sticker icon (${vibe}), ${locked}, rich warm palette: ${paletteText(palette)}, main icon: ${object}, add accents: ${accents}, commercial clipart style, no text, no realism, no brand logos, no watermark.`;
      } else {
        return `Urban fiction quote sticker (${vibe}), ${locked}, rich warm palette: ${paletteText(palette)}, caption text only: ‚Äú${text}‚Äù in bold modern typography, add small accent marks: ${accents}, commercial clipart style, no realism, no brand logos, no watermark.`;
      }
    }

    function buildPackagingPrompt({ locked, palette, accents, productKey, title, subtitle }){
      const t = PRODUCT_TEMPLATES[productKey];
      // Packaging-style prompts are purpose-built for Ideogram stickers:
      return `Cute flat vector clipart sticker illustration of ${t.subject} labeled ‚Äú${title}‚Äù subtitle ‚Äú${subtitle}‚Äù, ${locked}, rich warm palette: ${paletteText(palette)}, add accents: ${accents}, ${t.extras}, clean commercial packaging aesthetic, crisp vector clarity, no realism, no brand logos, no watermark.`;
    }

    // ---- Build prompt(s) output (1‚Äì5) ----
    function buildPromptBundle(){
      const genre = document.getElementById("genre").value;
      const vibe = document.getElementById("vibe").value;
      const type = document.getElementById("type").value;
      const object = document.getElementById("object").value;
      const accents = document.getElementById("accents").value;
      const palette = document.getElementById("palette").value;
      const border = document.getElementById("border").value;
      const outline = document.getElementById("outline").value;

      const useRandom = document.getElementById("useRandom").checked;
      const enhancedType = document.getElementById("enhancedType").checked;

      const count = parseInt(document.getElementById("count").value, 10);
      const selectedProducts = getSelectedValues(document.getElementById("products"));

      const userTitle = document.getElementById("titleText").value.trim();
      const userSubtitle = document.getElementById("subtitleText").value.trim();
      
      const prompts = [];
      for(let i=0; i<count; i++){
  const p = buildSinglePrompt({
    genre, vibe, type, object, accents, palette, border, outline,
    useRandom, enhancedType, selectedProducts, index: i,
    spiceLevel, spiceStampOn, userTitle, userSubtitle
  });
  prompts.push(`Prompt ${i+1}:\n${p}`);
}

      const negative =
        "photorealistic, blurry, low-res, messy outline, uneven line weight, distorted anatomy, extra fingers, bad hands, watermark, signature, brand logos, copyrighted characters, celebrity likeness, random words, tiny unreadable text blocks, background scene, busy gradients, harsh shadows, poster design, UI elements";

      const notes =
`Export settings:
- Format: PNG
- Background: Transparent
- Size: 2000‚Äì3000px (crisp for stickers)

Ideogram text tip:
- If letters distort, re-run once.
- Keep titles short (2‚Äì4 words) for best clarity.

If the output has a background:
1) Remove background (remove.bg / Canva BG remover)
2) Add white sticker outline (Canva: Edit Image ‚Üí Shadows ‚Üí Glow; set color white, blur 0, size up)

Packaging tip:
- Sell 40‚Äì60 PNGs per pack + include a preview sheet + 1‚Äì2 mockups.`;

      return { body: prompts.join("\n\n"), negative, notes };
    }

    function showToast(msg){
      const t = document.getElementById("toast");
      t.textContent = msg;
      t.classList.add("show");
      setTimeout(()=> t.classList.remove("show"), 1100);
    }

    function setStatus(text){
      const pill = document.getElementById("statusPill");
      pill.textContent = text;
    }

    function generate(){
      const { body, negative, notes } = buildPromptBundle();
      document.getElementById("promptOut").value = body;
      document.getElementById("negOut").value = negative;
      document.getElementById("notesOut").value = notes;
      setStatus("Generated ‚úÖ");
      setTimeout(()=>setStatus("Ready"), 900);
    }

    async function copyPrompt(){
      const prompt = document.getElementById("promptOut").value.trim();
      if(!prompt){
        showToast("Generate first");
        return;
      }
      try{
        await navigator.clipboard.writeText(prompt);
        showToast("Prompt copied");
      } catch(e){
        const ta = document.getElementById("promptOut");
        ta.focus(); ta.select();
        document.execCommand("copy");
        showToast("Copied");
      }
    }

    function randomizeAll(){
      const genre = document.getElementById("genre");
      const vibe = document.getElementById("vibe");
      const type = document.getElementById("type");
      const object = document.getElementById("object");
      const accents = document.getElementById("accents");
      const palette = document.getElementById("palette");
      const border = document.getElementById("border");
      const outline = document.getElementById("outline");
      const useRandom = document.getElementById("useRandom");
      const enhancedType = document.getElementById("enhancedType");

      genre.selectedIndex = Math.floor(Math.random() * genre.options.length);
      vibe.selectedIndex = Math.floor(Math.random() * vibe.options.length);
      type.selectedIndex = Math.floor(Math.random() * type.options.length);
      object.selectedIndex = Math.floor(Math.random() * object.options.length);
      accents.selectedIndex = Math.floor(Math.random() * accents.options.length);
      palette.selectedIndex = Math.floor(Math.random() * palette.options.length);
      border.selectedIndex = 0; // white border default
      outline.selectedIndex = 0; // thick outline default
      useRandom.checked = true;
      enhancedType.checked = true;
      document.getElementById("quote").value = "";

      const spice = document.getElementById("spice");
      const spiceStamp = document.getElementById("spiceStamp");

      if (spice) {
  spice.selectedIndex = Math.floor(Math.random() * spice.options.length);
}
      if (spiceStamp) {
  spiceStamp.checked = true;
}

      document.getElementById("titleText").value = "";
      document.getElementById("subtitleText").value = "";
      
      // Randomly select 0‚Äì3 product types sometimes
      const products = document.getElementById("products");
      Array.from(products.options).forEach(o => o.selected = false);
      const pickCount = Math.floor(Math.random() * 4); // 0-3
      for(let i=0; i<pickCount; i++){
        const opt = products.options[Math.floor(Math.random() * products.options.length)];
        opt.selected = true;
      }

      generate();
      showToast("Randomized");
    }

    function clearAll(){
      // reset selects/inputs to friendly defaults
      document.getElementById("genre").value = "urban_fiction";
      document.getElementById("count").value = "3";
      document.getElementById("vibe").selectedIndex = 0;
      document.getElementById("type").selectedIndex = 0;
      document.getElementById("object").selectedIndex = 0;
      document.getElementById("accents").selectedIndex = 0;
      document.getElementById("palette").selectedIndex = 0;
      document.getElementById("border").selectedIndex = 0;
      document.getElementById("outline").selectedIndex = 0;

      document.getElementById("useRandom").checked = true;
      document.getElementById("enhancedType").checked = true;
      document.getElementById("quote").value = "";
      document.getElementById("titleText").value = "";
      document.getElementById("subtitleText").value = "";
      document.getElementById("spice").value = "3";
      document.getElementById("spiceStamp").checked = true;
      
      // clear product multiselect
      const products = document.getElementById("products");
      Array.from(products.options).forEach(o => o.selected = false);

      // clear outputs
      document.getElementById("promptOut").value = "";
      document.getElementById("negOut").value = "";
      document.getElementById("notesOut").value = "";
      setStatus("Ready");
      showToast("Cleared");
    }

    document.getElementById("generateBtn").addEventListener("click", generate);
    document.getElementById("copyBtn").addEventListener("click", copyPrompt);
    document.getElementById("randomBtn").addEventListener("click", randomizeAll);
    document.getElementById("clearBtn").addEventListener("click", clearAll);

    // Auto-generate on load for instant usefulness
    window.addEventListener("load", generate);
  </script>
</body>
</html>
